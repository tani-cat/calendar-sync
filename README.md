# Calendar Sync

Google Calendarにおいてインポートしてきたカレンダーを、単一のカレンダーに統合、同期させるスクリプト

## 導入方法

1. 自分のGoogle Driveにスクリプトを配置する(clasp等を利用するなど)
   - 手動で入れる場合は `Google Calendar API v3` を有効にしてください
   - `.clasp.json` の `"rootDir"` は `"./src"` にする
2. スクリプトプロパティに `target` キーをもつ値を設定し、値には反映先のカレンダーIDを設定する

## 動作

1. 外部からインポートしたカレンダー(以下、ソース)を認識し、カレンダーからイベントを取得する
   - ソースのカレンダーは1つでも複数でもOK
2. 反映先のカレンダー(以下、ターゲット)のイベントと各ソースのイベントを比較し、IDが一致するかどうかを調べる
   1. IDの一致するイベントが双方にある場合は、更新日時を比較して適宜ターゲット側を更新する
   2. ソース側にイベントが残っていない場合は、ターゲット側のイベントを削除する
3. ターゲットに存在しないイベントを新規追加する

## 今後のTodo

- 繰り返しイベントを取得できていない(たぶんEventServiceを見る必要がある)
- 1日イベントは紛らわしいので除外している(オプション設定を組み込む)
- もうちょっと使い勝手をよくする
